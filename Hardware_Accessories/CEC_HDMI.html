<!DOCTYPE html>
<!--[if lt IE 7]>       <html class="no-js ie6 oldie" lang="en"> <![endif]-->
<!--[if IE 7]>          <html class="no-js ie7 oldie" lang="en"> <![endif]-->
<!--[if IE 8]>          <html class="no-js ie8 oldie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!-->  <html class="no-js" lang="en"> <!--<![endif]-->
<head>
    <title>CEC-HDMI - UDOO X86 Docs</title>
    <meta name="description" content="UDOO X86 Documentation" />
    <meta name="author" content="UDOO Team">
    <meta charset="UTF-8">
    <link rel="icon" href="../themes/daux/img/favicon-udoo.ico" type="image/x-icon">
    <!-- Mobile -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Font -->
    <link href='https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700&subset=latin' rel='stylesheet' type='text/css'>
    <!-- CSS -->
    <link href='../themes/daux/css/theme-navy.min.css' rel='stylesheet' type='text/css'><link href='../themes/daux/css/udoo.css' rel='stylesheet' type='text/css'>
            <!-- Tipue Search -->
        <link href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    <!-- jQuery -->
    <script src="../themes/daux/js/jquery-1.11.3.min.js"></script>
    <script src="../themes/daux/js/bootstrap.min.js"></script>

    <!--[if lt IE 9]>
    <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
</head>
<body class="">
    
<header class="Navbar hidden-print">
    <img class="pull-left udoologo" src="../img/logo_docs.png"> 
<a class="Navbar__brand" href="../index.html">
UDOO X86 Documentation</a>

    <div class="Search">
        <svg class="Search__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 451 451"><path d="M447.05 428l-109.6-109.6c29.4-33.8 47.2-77.9 47.2-126.1C384.65 86.2 298.35 0 192.35 0 86.25 0 .05 86.3.05 192.3s86.3 192.3 192.3 192.3c48.2 0 92.3-17.8 126.1-47.2L428.05 447c2.6 2.6 6.1 4 9.5 4s6.9-1.3 9.5-4c5.2-5.2 5.2-13.8 0-19zM26.95 192.3c0-91.2 74.2-165.3 165.3-165.3 91.2 0 165.3 74.2 165.3 165.3s-74.1 165.4-165.3 165.4c-91.1 0-165.3-74.2-165.3-165.4z"/></svg>
        <input type="search" id="tipue_search_input" class="Search__field" placeholder="Search..." autocomplete="on" results=25 autosave=text_search>
    </div>
</header>
<div class="Columns content">
    <aside class="Columns__left Collapsible">
        <div class="Collapsible__container">
            <button type="button" class="Button Collapsible__trigger">
                <span class="Collapsible__trigger--bar"></span>
                <span class="Collapsible__trigger--bar"></span>
                <span class="Collapsible__trigger--bar"></span>
            </button>
        </div>

        <div class="Collapsible__content">
            <!-- Navigation -->
            <ul class='Nav'><li class='Nav__item  has-children'><a href="#" class="aj-nav folder"><i class="Nav__arrow">&nbsp;</i>Introduction</a><ul class='Nav'><li class='Nav__item '><a href="../Introduction/Introduction.html">Introduction</a></li></ul></li><li class='Nav__item  has-children'><a href="#" class="aj-nav folder"><i class="Nav__arrow">&nbsp;</i>Basic Setup</a><ul class='Nav'><li class='Nav__item '><a href="../Basic_Setup/Find_IP_Address.html">Find IP Address</a></li><li class='Nav__item '><a href="../Basic_Setup/Remote_Terminal_(SSH).html">Remote Terminal (SSH)</a></li><li class='Nav__item '><a href="../Basic_Setup/Remote_Desktop_(VNC).html">Remote Desktop (VNC)</a></li></ul></li><li class='Nav__item  has-children'><a href="#" class="aj-nav folder"><i class="Nav__arrow">&nbsp;</i>Operating Systems</a><ul class='Nav'><li class='Nav__item '><a href="../Operating_Systems/Linux.html">Linux</a></li><li class='Nav__item '><a href="../Operating_Systems/Windows.html">Windows</a></li><li class='Nav__item '><a href="../Operating_Systems/Android.html">Android</a></li><li class='Nav__item '><a href="../Operating_Systems/Yocto.html">Yocto</a></li><li class='Nav__item '><a href="../Operating_Systems/LibreELEC_with_CEC_support.html">LibreELEC with CEC support</a></li></ul></li><li class='Nav__item Nav__item--open has-children'><a href="#" class="aj-nav folder"><i class="Nav__arrow">&nbsp;</i>Hardware & Accessories</a><ul class='Nav'><li class='Nav__item '><a href="../Hardware_Accessories/Official_Accessories.html">Official Accessories</a></li><li class='Nav__item '><a href="../Hardware_Accessories/GPIOs.html">GPIOs</a></li><li class='Nav__item '><a href="../Hardware_Accessories/Bricks_snap_in_sensors.html">Bricks snap in sensors</a></li><li class='Nav__item Nav__item--active'><a href="../Hardware_Accessories/CEC_HDMI.html">CEC-HDMI</a></li><li class='Nav__item '><a href="../Hardware_Accessories/Consumer_IR.html">Consumer IR</a></li></ul></li><li class='Nav__item  has-children'><a href="#" class="aj-nav folder"><i class="Nav__arrow">&nbsp;</i>Cookbook Linux</a><ul class='Nav'><li class='Nav__item '><a href="../Cookbook_Linux/Understanding_Linux_Software_Management_And_Installing.html">Understanding Linux Software Management And Installing</a></li><li class='Nav__item '><a href="../Cookbook_Linux/Linux_Command_Line_Interface.html">Linux Command Line Interface</a></li><li class='Nav__item '><a href="../Cookbook_Linux/Intel_Graphics_update_tool.html">Intel Graphics update tool</a></li><li class='Nav__item '><a href="../Cookbook_Linux/Play_videos_in_GPU.html">Play videos in GPU</a></li></ul></li><li class='Nav__item  has-children'><a href="#" class="aj-nav folder"><i class="Nav__arrow">&nbsp;</i>Arduino 101 (Intel Curie)</a><ul class='Nav'><li class='Nav__item '><a href="../Arduino_101_(Intel_Curie)/Overview.html">Overview</a></li><li class='Nav__item '><a href="../Arduino_101_(Intel_Curie)/Getting_Started_with_Arduino_101.html">Getting Started with Arduino 101</a></li><li class='Nav__item '><a href="../Arduino_101_(Intel_Curie)/Pinout.html">Pinout</a></li><li class='Nav__item '><a href="../Arduino_101_(Intel_Curie)/Pattern_Matching_Engine.html">Pattern Matching Engine</a></li><li class='Nav__item '><a href="../Arduino_101_(Intel_Curie)/Braswell_Power_Management_From_Arduino_101.html">Braswell Power Management From Arduino 101</a></li><li class='Nav__item '><a href="../Arduino_101_(Intel_Curie)/Curie_Reset_on_PowerON.html">Curie Reset on PowerON</a></li></ul></li><li class='Nav__item  has-children'><a href="../Serial_Libraries/index.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Serial Libraries</a><ul class='Nav'><li class='Nav__item '><a href="../Serial_Libraries/Java_Serial_Libraries.html">Java Serial Libraries</a></li><li class='Nav__item '><a href="../Serial_Libraries/C_Serial_Libraries.html">C Serial Libraries</a></li><li class='Nav__item '><a href="../Serial_Libraries/PHP_Serial_Libraries.html">PHP Serial Libraries</a></li><li class='Nav__item '><a href="../Serial_Libraries/Python_Serial_Libraries.html">Python Serial Libraries</a></li></ul></li><li class='Nav__item  has-children'><a href="#" class="aj-nav folder"><i class="Nav__arrow">&nbsp;</i>Advanced Topics</a><ul class='Nav'><li class='Nav__item '><a href="../Advanced_Topics/UEFI_update.html">UEFI update</a></li><li class='Nav__item '><a href="../Advanced_Topics/EAPI.html">EAPI</a></li></ul></li><li class='Nav__item  has-children'><a href="#" class="aj-nav folder"><i class="Nav__arrow">&nbsp;</i>Hardware Reference</a><ul class='Nav'><li class='Nav__item '><a href="../Hardware_Reference/Overview.html">Overview</a></li><li class='Nav__item '><a href="../Hardware_Reference/Resources.html">Resources</a></li><li class='Nav__item '><a href="../Hardware_Reference/Board_versions.html">Board versions</a></li><li class='Nav__item '><a href="../Hardware_Reference/Video_Output.html">Video Output</a></li><li class='Nav__item '><a href="../Hardware_Reference/Storage_Options.html">Storage Options</a></li><li class='Nav__item '><a href="../Hardware_Reference/M.2_Connectors.html">M.2 Connectors</a></li><li class='Nav__item '><a href="../Hardware_Reference/UEFI_Firmware.html">UEFI Firmware</a></li><li class='Nav__item '><a href="../Hardware_Reference/Pinout_Braswell.html">Pinout Braswell</a></li><li class='Nav__item '><a href="../Hardware_Reference/Recognize_the_UDOO_X86_revision.html">Recognize the UDOO X86 revision</a></li></ul></li></ul>

            <div class="Links">
                                    <hr/>
                                            <a href="https://www.udoo.org" target="_blank">Home</a>
                        <br />
                                            <a href="https://www.udoo.org/other-resources/" target="_blank">Downloads</a>
                        <br />
                                            <a href="https://www.udoo.org/tutorial" target="_blank">Tutorials</a>
                        <br />
                                            <a href="https://www.udoo.org/forum" target="_blank">Forum</a>
                        <br />
                                            <a href="https://github.com/UDOOboard/X86-Docs" target="_blank">Github Docs</a>
                        <br />
                                    
                
                            </div>
        </div>
    </aside>
    <div class="Columns__right ">
        <div class="Columns__right__content">
            <div class="doc_content">
                <article class="Page">

    <div class="Page__header">
        <h1>CEC-HDMI</h1>
            </div>


    <div class="s-content">
        <h2 id="page_CEC-Introduction">CEC Introduction</h2>
<p>Quoting from the Wikipedia page of the <a href="https://en.wikipedia.org/wiki/Consumer_Electronics_Control" class="Link--external">CEC</a>:</p>
<blockquote>
<p>Consumer Electronics Control (CEC) is a feature of HDMI designed to allow users to command and control devices connected through HDMI by using only one remote control. For example by using the remote control of a television set to control a set-top box and or DVD player. Up to 15 devices can be controlled. CEC also allows for individual CEC-enabled devices to command and control each other without user intervention.</p>
</blockquote>
<p>UDOO X86’s HDMI 1.4b supports CEC so we decided to develop the driver for the CEC of our board by adopting the new Linux standard <strong>CEC Framework</strong>.</p>
<h2 id="page_CEC-Framework">CEC Framework</h2>
<p>The Linux Kernel includes, since the 4.8 version, a standard HDMI-CEC framework to provide a unified kernel interface for use with HDMI-CEC hardware.</p>
<p>Quoting from the <a href="https://www.kernel.org/doc/html/v4.11/media/kapi/cec-core.html#" class="Link--external">official CEC framework documentation</a>:</p>
<blockquote>
<p>The framework also gives the option to decide what to do in the kernel driver and what should be handled by userspace applications. In addition it integrates the remote control passthrough feature into the kernel’s remote control framework.
This new HDMI-CEC framework just acts like an API that allows manufacturers to easily write 'device drivers' that can talk to all different type of CEC hardware. The framework exposes CEC as a remote control input device allowing to any generic hardware to have standard syscalls to user-space application.</p>
</blockquote>
<p>With the new Linux kernels, most of the future hardware as well as the current ones, will be supported directly.
This CEC Framework sets itself as a standard that will be adopted by all manufacturers to support CEC in their hardware and should be adopted by media applications soon.</p>
<p>Here you can find <a href="http://events.linuxfoundation.org/sites/events/files/slides/cec-wide_1.pdf" class="Link--external">details on the framework</a> by the developer Hans Verkuil from Cisco.</p>
<h3 id="page_State-of-Art-libCEC">State of Art - libCEC</h3>
<p><a href="http://libcec.pulse-eight.com/" class="Link--external">libCEC</a> is a well established user-space
library.
Many graphical media applications, like Kodi, use the libCEC platform in its
own code to interact with CEC protocol.</p>
<p>Now that a standard HDMI-CEC Framework is integrated into the Linux Kernel,
future hardware will probably adopt it. LibCEC still has a pending <a href="https://github.com/Pulse-Eight/libcec/pull/380" class="Link--external">Pull Request</a> at
the time of writing (2019/07/12) in order to add support for the Linux Framework.</p>
<p><a href="https://libreelec.tv/" class="Link--external">LibreELEC</a>, a Linux distro for Kodi, has an option to add the patch and enabling
the support, but it's not available in the official images. In the section
<a href="../Operating_Systems/LibreELEC_with_CEC_support.html">LibreELEC with CEC
support</a> is possible
to download a custom version with the CEC Support enabled.</p>
<p>libCEC issue on github about adding the CEC Framework support - <a href="https://github.com/Pulse-Eight/libcec/issues/67" class="Link--external">GitHub link</a>.</p>
<p>Kodi thread about using the CEC Framework alternatively to libCEC - <a href="http://forum.kodi.tv/showthread.php?tid=293256" class="Link--external">KODI Forum thread</a>.</p>
<h2 id="page_Compile-and-mount-the-seco-cec-driver-for-UDOO-X86">Compile and mount the seco-cec driver for UDOO X86</h2>
<h3 id="page_Use">Use</h3>
<p><span class="label label-warning">Heads up!</span>
Make sure you have installed an updated FW version (<strong>&gt;= 1.04</strong>) on your UDOO X86 (check this in BIOS Main Page).</p>
<p>In order to use the driver, there are several methods:</p>
<ul>
<li>Install Linux Kernel version &gt; 5.0 with <code>CONFIG_VIDEO_SECO_CEC</code> and, optionally, <code>CONFIG_VIDEO_SECO_RC</code> (for IR) enabled</li>
<li>Use DKMS (Dynamic Kernel Module System)</li>
<li>Compile and mount the module manually</li>
</ul>
<p><span class="label label-warning">Heads up!</span>
If you are compiling, make sure you have Linux <strong>kernel headers &gt;= 4.19</strong> and <em>CEC_NOTIFIER</em> enabled
(if you want to compile with headers &gt;= 4.14 you need to use version <a href="https://github.com/ektor5/secocec/releases/tag/v0.1" class="Link--external">0.1</a> ).</p>
<h2 id="page_DKMS">DKMS</h2>
<p>DKMS is an automatic system for mounting and managing Linux external modules.
It is really useful in case of a kernel update or for automounting the module
at boot.</p>
<pre><code class="language-bash"># install dependencies (make, git, ecc..)
sudo apt install git build-essential linux-headers-`uname -r` dkms

# clone repo
git clone https://github.com/ektor5/secocec

# go to dir
cd secocec

# create dkms directory
sudo mkdir '/usr/src/secocec-1.0'

# copy files
sudo cp seco-cec.? dkms.conf Makefile '/usr/src/secocec-1.0'

# install module
sudo dkms install secocec/1.0 -k `uname -r`
</code></pre>
<p>Now at reboot the module will be mounted automatically.</p>
<h2 id="page_Compile">Compile</h2>
<p>Install dependencies (make, git, ecc..)</p>
<pre><code>sudo apt install git build-essential linux-headers-`uname -r`
</code></pre>
<p>Download the source code from git</p>
<pre><code>git clone https://github.com/ektor5/secocec.git
</code></pre>
<p>Enter into the dir just downloaded:</p>
<pre><code>cd secocec
</code></pre>
<p>compile the driver:</p>
<pre><code>make
</code></pre>
<p>The module should appear as file called <code>seco-cec.ko</code>.</p>
<h3 id="page_Mount">Mount</h3>
<p>This module depends on the Linux CEC Framework Module, and it needs to be loaded first.</p>
<pre><code>modprobe cec
</code></pre>
<p><em>Note:</em> this module conflicts with the official SMBus driver <code>i2c-i801</code> and therefore it needs to be blacklisted. On Ubuntu should be already blacklisted, if you're using</p>
<pre><code>echo &quot;blacklist i2c-i801&quot; &gt; /etc/modprobe.d/i2c-i801.conf
</code></pre>
<p>Load the module:</p>
<pre><code>insmod seco-cec.ko
</code></pre>
<p>Done, the module is now loaded and working!</p>
<h2 id="page_How-to-use-the-driver-with-file-system-applications">How to use the driver with file system applications</h2>
<p>The CEC Framework expose all the CEC functionalities of the CEC protocol through a file system device <code>/dev/cec0</code> so the applications can access directly this file.
Since the CEC Framework is quite new there are still few applications that exploits all functions provided by the Framework.</p>
<p>To test the device from userspace (<code>/dev/cec0</code>), there are some programs ready to use in <em>v4l-utils</em> tools package (available to install via apt):</p>
<ul>
<li>
<strong>cec-ctl</strong>: An application to control cec devices</li>
<li>
<strong>cec-compliance</strong>: An application to verify remote CEC devices</li>
<li>
<strong>cec-follower</strong>: An application to emulate CEC followers</li>
</ul>
<p>You can check the official <a href="https://www.mankier.com/package/v4l-utils" class="Link--external">man pages</a> for info.</p>
<p>Install v4l-utils</p>
<pre><code>apt install v4l-utils
</code></pre>
<p>Following you can find some examples.</p>
<p>Register the CEC device (UDOO X86) in the CEC network using the physical and logical address:</p>
<pre><code>cec-ctl --phys-addr=2.0.0.0 \
        --playback
</code></pre>
<p>Power on tv</p>
<pre><code>cec-ctl --active-source=phys-addr=2.0.0.0 --image-view-on -t0
</code></pre>
<p>Power off tv</p>
<pre><code>cec-ctl --standby -t0
</code></pre>
<p>Enable TV remote (it depends on manufacturers protocol)
E.g. SimpLink by LG.</p>
<pre><code>cec-ctl --phys-addr=2.0.0.0 \
        --playback \
        --custom-command=cmd=0x89,payload=0x02:0x05 \
        --deck-status=deck-info=0x01 \
        --menu-status=menu-state=0x00 \
        --custom-command=cmd=0x89,payload=0x05:0x01 \
        --report-power-status=pwr-state=0 -t0
</code></pre>
<p>With this command the TV remote keys are interpreted by the OS as a standard keyboard and you can use it to interact with the OS applications like Kodi for examples.</p>
<h3 id="page_Edit-keymaps">Edit keymaps</h3>
<p>Sometimes, not all the remote keys are set like we want it to be.<br />
E.g: the <em>OK</em> button is not understood as <em>Enter</em> by the X server input module (Xinput), so it is necessary to remap it.</p>
<p>To edit the keymap do the following:</p>
<p>Install ir-keytable package:</p>
<pre><code>apt install ir-keytable
</code></pre>
<p>Get the current keytable:</p>
<pre><code>ir-keytable -r &gt; seco-cec-keytable.conf
</code></pre>
<p>Edit the file with a text editor (e.g. vim):</p>
<pre><code>vim seco-cec-keytable.conf
</code></pre>
<p>Rewrite it to the driver</p>
<pre><code>ir-keytable -w seco-cec-keytable.conf
</code></pre>
<p>Done!</p>
    </div>

        <nav>
        <ul class="Pager">
            <li class=Pager--prev><a href="../Hardware_Accessories/Bricks_snap_in_sensors.html">Previous</a></li>            <li class=Pager--next><a href="../Hardware_Accessories/Consumer_IR.html">Next</a></li>        </ul>
    </nav>
    
<span style="float: left; font-size: 10px; color: gray;">
This page was last updated on Monday, March 21, 2022 at 5:26 AM.
</span>

</article>

            </div>
        </div>
    </div>
</div>

    
    <!-- hightlight.js -->
    <script src="../themes/daux/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- JS -->
    
    <script src="../themes/daux/js/daux.js"></script>

            <!-- Tipue Search -->
        <script type="text/javascript" src="../tipuesearch/tipuesearch.js"></script>

        <script>
            window.onunload = function(){}; // force $(document).ready to be called on back/forward navigation in firefox
            $(function() {
                tipuesearch({
                    'base_url': '../'
                });
            });
        </script>
    
</body>
</html>
